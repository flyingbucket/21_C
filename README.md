## 简介 
本仓库中内容旨在求解全国大学生数学建模大赛2021年C题

本项目含有一个主分支，3个开发分支；开发分支中最有价值且仍在维护的是dev3。具体分析见“不足之处”。

ps.这是我的第一个项目，完全自学，知识主要来源于B站、zlib和gpt，所以有很多不专业的地方，还请前辈不吝赐教。

## 环境配置
本项目使用python开发，所有第三方依赖库都已写在requirements.txt内，只需在本地激活虚拟环境后，在终端运行
```
pip install -r "requirements.txt"
```
即可自动安装所有依赖包。

## 内容介绍
1. “原题”文件夹保存了21年C题的全部内容。这是一道运筹优化类问题，具体场景如下：
   一家工厂需要向多家供应商采购原材料以维持原材料供应的稳定性，原材料由多家转运商负责运输；该工厂以24周为一个周期来规划生产，已知过去10个周期240周的数据；要求根据已知数据给出未来24周的最佳采购方案和运输方案。
   更多具体内容可查看原题文档。

2. 各个分支的“.venv”文件夹包含了该分支的python源代码，值得一提的是本项目的python代码均使用绝对路径来调取所需数据或文件，为大家带来不便，还请谅解。

3. “data”文件夹包含了主要的原始数据和中间步骤数据

4. “result”文件夹用于存储运行结果

## 模型与算法
本项目主要采取多目标优化的思路，按照每一小问的具体要求建立了多目标优化模型，最小化成本和损耗，最大化产能（取倒数以适应最小化模型）；模型函数见于Q1.py,Q2_1.pu,Q2_2.py,Q3.py,Q4.py。

在第一问中采用熵权-topsis法为供应商打分并排序，求解出最重要的50家供应商；

后续问题均采用遗传算法求解对应的多目标优化问题。分别运行GA.py,GA3.py，GA4.py解决第2-2问、第三问和第四问。所有遗传算法均依托于deap库所提供的进化算法框架实现。

## 不足之处
本问题的两个目标就是找到最优的转运商和供应商选择方案。在建模时，本项目使用决策变量x和y来代表转运商和供应商的选择，根据第一问的运行结果，后续问题中供应商都在第一问选择出的50家优质供应商中选择。
x和y均为50维数组，y是50维01数组，第i位为1表示从第i家供应商进货，第i位为0则表示不从该供应商处进货；可供选择的转运商有8家，编号1到8，x各位元素从整数1到8选取，表示第i家供货商的货物由哪一家转运商运送，x与y逐位相乘即得转运商的选择。
x和y合并在一起为遗传算法的一个个体individual。

这时算法的弊端就会显现出来，individual共有2**50*8**50=2**200种可能的选择；在如此庞大的搜索空间中，考虑到硬件限制，我将种群大小设为10到2500之间的一个数，这时运行程序就会发现，
往往整个种群的全部个体都不能满足基本约束条件进而被赋予极大的适应度值，这样的种群在交叉变异的过程中始终没有一个个体能满足基本约束条件。这就使得遗传算法求得的结果几乎完全靠运气，大多是时候迭代数百代后仍不收敛。

在dev3中，我为了缩小搜索空间，采取了逐步收紧约束条件的策略，将约束条件的严格程度划分为400个梯度，采用遗传算法逐渐筛选出符合约束条件的种群；但是由于种群规模不能设置得太大，我选择了6000左右得种群规模，使用python多进程加速计算，
但这仍然意味着我需要在第一步也就是约束条件最宽松的那一步抛弃搜索空间中绝大部分可能解，选出6000左右个个体进行迭代；事实证明这种缺陷是致命的，往往在约束条件收紧到第25个梯度时，种群中就没有一个个体能够满足约束条件了，这里400级还有很大距离。

所以当下最大的问疑问是如何在不损失决策全局性的前提下尽可能缩小搜索空间，烦请各位大佬多多指教。

